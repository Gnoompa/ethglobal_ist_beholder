{"version":3,"file":"bundled/chunk.8571.js","mappings":"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","sources":["webpack://mask-network/./packages/base/src/utils/parseURLs.ts","webpack://mask-network/./packages/encryption/src/network-encoding/twitter.ts","webpack://mask-network/./packages/mask/content-script/components/DataSource/useActivatedUI.ts","webpack://mask-network/./packages/mask/content-script/site-adaptor-infra/ui.ts","webpack://mask-network/./packages/mask/content-script/site-adaptors/utils.ts","webpack://mask-network/./packages/theme/src/ShadowRoot/attachReactTreeToMountedRoot.tsx","webpack://mask-network/./packages/shared/src/UI/contexts/SiteUIProvider.tsx","webpack://mask-network/./packages/mask/content-script/components/useMaskSiteAdaptorMixedTheme.ts","webpack://mask-network/./packages/mask/content-script/utils/shadow-root/ShadowRootAttachPointRoot.tsx","webpack://mask-network/./packages/mask/content-script/utils/shadow-root/renderInShadowRoot.tsx","webpack://mask-network/./packages/mask/content-script/utils/startWatch.ts","webpack://mask-network/./packages/plugin-infra/src/manager/extension-page.ts","webpack://mask-network/./packages/plugin-infra/src/manager/site-adaptor.ts","webpack://mask-network/./packages/plugin-infra/src/site-adaptor/context.ts","webpack://mask-network/./packages/plugin-infra/src/site-adaptor/useThemeSettings.ts","webpack://mask-network/./packages/plugin-infra/src/utils/theme/color-tools.ts","webpack://mask-network/./packages/shared-base/src/LegacySettings/settings.ts","webpack://mask-network/./packages/shared-base/src/types/Observable.ts","webpack://mask-network/./packages/shared-base/src/types/SetupGuide.ts","webpack://mask-network/./packages/theme/src/CSSVariables/applyToDOM.ts","webpack://mask-network/./packages/theme/src/ShadowRoot/ShadowRootSetup.tsx","webpack://mask-network/./packages/web3-hooks/base/src/useBeat.ts","webpack://mask-network/./node_modules/.pnpm/@tanstack+react-query@4.29.25_react-dom@0.0.0-experimental-0a360642d-20230711_react@0.0.0-exp_ph45ttbltampqv75cnp6zhp25e/node_modules/@tanstack/react-query/build/lib/isRestoring.mjs"],"sourcesContent":["import * as parser from /* webpackDefer: true */ 'anchorme'\nexport function parseURLs(text: string, requireProtocol = true) {\n    // CJS-ESM compatibility\n    const lib = parser.default.default || parser.default\n    return lib\n        .list(text)\n        .map((x) => x.string)\n        .filter((y) => {\n            if (!requireProtocol) return true\n            // See https://github.com/alexcorvi/anchorme.js/issues/109\n            return URL.canParse(y)\n        })\n}\n","import { decodeArrayBuffer, encodeArrayBuffer } from '@masknet/kit'\nimport { parseURLs } from '@masknet/base'\nimport { Some, None, type Option } from 'ts-results-es'\n\nexport function __TwitterEncoder(data: Uint8Array | string) {\n    if (typeof data === 'string') return __TwitterEncoderText(data)\n    return __TwitterEncoderBinary(data)\n}\n/**\n * @link https://github.com/DimensionDev/Maskbook/issues/198\n */\nfunction __TwitterEncoderText(text: string) {\n    return (\n        'https://mask.io/?PostData_v1=' +\n        text\n            //\n            .replace('\\u{1F3BC}', '%20')\n            .replace(':||', '%40')\n            .replace('+', '-')\n            .replace('=', '_')\n            .replaceAll('|', '.')\n    )\n}\nfunction __TwitterEncoderBinary(data: Uint8Array) {\n    return `https://mask.io/?PostData_v2=${encodeURIComponent(encodeArrayBuffer(data))}`\n}\n\nexport function TwitterDecoder(raw: string): Option<string | Uint8Array> {\n    const newVersion = TwitterDecoderBinary(raw)\n    if (newVersion.isSome()) return newVersion\n\n    return TwitterDecoderText(raw)\n}\n\nfunction TwitterDecoderBinary(raw: string): Option<Uint8Array> {\n    if (!raw) return None\n    if (!raw.includes('PostData_v2')) return None\n\n    const payloadLink = parseURLs(raw).filter((x) => x.startsWith('https://mask.io/?PostData_v2='))\n    try {\n        for (const link of payloadLink) {\n            const url = new URL(link)\n            const payload = url.searchParams.get('PostData_v2')\n            if (!payload) continue\n            return Some(new Uint8Array(decodeArrayBuffer(payload)))\n        }\n    } catch {\n        return None\n    }\n    return None\n}\nfunction TwitterDecoderText(raw: string): Option<string> {\n    if (!raw) return None\n    if (!raw.includes('%20') || !raw.includes('%40')) return None\n    const payloadLink = parseURLs(raw)\n        .map((x) => x.replace(/\\u2026$/, ''))\n        .filter((x) => x.endsWith('%40'))[0]\n    if (!URL.canParse(payloadLink)) return None\n    const { search, pathname } = new URL(payloadLink)\n    const payload = search ? search.slice(1) : pathname.slice(1)\n    if (!payload) return None\n    return Some(\n        '\\u{1F3BC}' +\n            payload\n                // https://github.com/sindresorhus/eslint-plugin-unicorn/issues/1476\n                // eslint-disable-next-line unicorn/better-regex\n                .replace(/^PostData_v\\d=/i, '')\n                .replace(/^%20/, '')\n                .replace(/%40$/, '')\n                .replace('-', '+')\n                .replace('_', '=')\n                .replaceAll('.', '|') +\n            ':||',\n    )\n}\n","import type { IdentityResolved } from '@masknet/plugin-infra'\nimport { MaskMessages, ValueRef, type ProfileInformation } from '@masknet/shared-base'\nimport { useValueRef } from '@masknet/shared-base-ui'\nimport { NextIDProof } from '@masknet/web3-providers'\nimport { FontSize, ThemeColor, ThemeMode, type ThemeSettings } from '@masknet/web3-shared-base'\nimport { useQuery } from '@tanstack/react-query'\nimport { first, isEqual } from 'lodash-es'\nimport { useEffect, useMemo } from 'react'\nimport { useSubscription, type Subscription } from 'use-subscription'\nimport Services from '#services'\nimport { activatedSiteAdaptorUI, activatedSiteAdaptor_state } from '../../site-adaptor-infra/index.js'\n\nasync function queryPersonaFromDB(identityResolved: IdentityResolved) {\n    if (!identityResolved.identifier) return\n    return Services.Identity.queryPersonaByProfile(identityResolved.identifier)\n}\n\nasync function queryPersonasFromNextID(identityResolved: IdentityResolved) {\n    if (!identityResolved.identifier) return\n    if (!activatedSiteAdaptorUI!.configuration.nextIDConfig?.platform) return\n    return NextIDProof.queryAllExistedBindingsByPlatform(\n        activatedSiteAdaptorUI!.configuration.nextIDConfig?.platform,\n        identityResolved.identifier.userId,\n    )\n}\n\nconst CurrentIdentitySubscription: Subscription<ProfileInformation | undefined> = {\n    getCurrentValue() {\n        const all = activatedSiteAdaptor_state!.profiles.value\n        const current = (activatedSiteAdaptorUI!.collecting.identityProvider?.recognized || defaultIdentityResolved)\n            .value.identifier\n        return all.find((i) => i.identifier === current) || first(all)\n    },\n    subscribe(sub) {\n        const a = activatedSiteAdaptor_state!.profiles.addListener(sub)\n        const b = activatedSiteAdaptorUI!.collecting.identityProvider?.recognized.addListener(sub)\n        return () => [a(), b?.()]\n    },\n}\n\nconst defaults = {\n    mode: ThemeMode.Light,\n    size: FontSize.Normal,\n    color: ThemeColor.Blue,\n}\nconst defaultIdentityResolved = new ValueRef<IdentityResolved>({}, isEqual)\nconst defaultThemeSettings = new ValueRef<Partial<ThemeSettings>>({}, isEqual)\n\nexport function useCurrentIdentity() {\n    return useSubscription(CurrentIdentitySubscription)\n}\n\nexport function useLastRecognizedIdentity() {\n    return useValueRef(activatedSiteAdaptorUI!.collecting.identityProvider?.recognized || defaultIdentityResolved)\n}\n\nexport function useCurrentVisitingIdentity() {\n    return useValueRef(\n        activatedSiteAdaptorUI!.collecting.currentVisitingIdentityProvider?.recognized || defaultIdentityResolved,\n    )\n}\n\n/**\n * Get the social identity of the given identity\n */\nexport function useSocialIdentity(identity: IdentityResolved | null | undefined) {\n    const result = useQuery({\n        enabled: !!identity,\n        queryKey: ['social-identity', identity],\n        queryFn: async () => {\n            if (!identity) return null\n            try {\n                const bindings = await queryPersonasFromNextID(identity)\n                const persona = await queryPersonaFromDB(identity)\n                const personaBindings =\n                    bindings?.filter((x) => x.persona === persona?.identifier.publicKeyAsHex.toLowerCase()) ?? []\n                return {\n                    ...identity,\n                    publicKey: persona?.identifier.publicKeyAsHex,\n                    hasBinding: personaBindings.length > 0,\n                    binding: first(personaBindings),\n                }\n            } catch {\n                return identity\n            }\n        },\n    })\n\n    useEffect(() => MaskMessages.events.ownProofChanged.on(() => result.refetch()), [result.refetch])\n\n    return result\n}\n\nexport function useSocialIdentityByUserId(userId?: string) {\n    const { data: identity } = useQuery(\n        ['social-identity', 'by-id', userId],\n        async () => {\n            if (!userId) return\n            return activatedSiteAdaptorUI!.utils.getUserIdentity?.(userId)\n        },\n        { networkMode: 'always' },\n    )\n    return useSocialIdentity(identity)\n}\n\nexport function useThemeSettings() {\n    const themeSettings = useValueRef(\n        (activatedSiteAdaptorUI?.collecting.themeSettingsProvider?.recognized ||\n            defaultThemeSettings) as ValueRef<ThemeSettings>,\n    )\n    return useMemo<ThemeSettings>(\n        () => ({\n            ...defaults,\n            ...activatedSiteAdaptorUI?.configuration.themeSettings,\n            ...themeSettings,\n        }),\n        [activatedSiteAdaptorUI?.configuration.themeSettings, themeSettings],\n    )\n}\n","import { createElement } from 'react'\nimport stringify from 'json-stable-stringify'\nimport { assertNotEnvironment, Environment } from '@dimensiondev/holoflows-kit'\nimport { delay, waitDocumentReadyState } from '@masknet/kit'\nimport type { SiteAdaptorUI } from '@masknet/types'\nimport { type Plugin, startPluginSiteAdaptor, __setSiteAdaptorContext__ } from '@masknet/plugin-infra/content-script'\nimport { Modals, sharedUIComponentOverwrite, sharedUINetworkIdentifier, type ModalProps } from '@masknet/shared'\nimport {\n    createSubscriptionFromValueRef,\n    currentPersonaIdentifier,\n    currentSetupGuideStatus,\n    DashboardRoutes,\n    ECKeyIdentifier,\n    i18NextInstance,\n    queryRemoteI18NBundle,\n    type SetupGuideContext,\n    SetupGuideStep,\n    setDebugObject,\n} from '@masknet/shared-base'\nimport { Flags } from '@masknet/flags'\nimport { Telemetry } from '@masknet/web3-telemetry'\nimport { ExceptionID, ExceptionType } from '@masknet/web3-telemetry/types'\nimport { createSharedContext, createPluginHost } from '../../shared/plugin-infra/host.js'\nimport Services from '#services'\nimport { getCurrentIdentifier } from '../site-adaptors/utils.js'\nimport { attachReactTreeWithoutContainer, setupReactShadowRootEnvironment } from '../utils/shadow-root.js'\nimport { configureSelectorMissReporter } from '../utils/startWatch.js'\nimport { setupUIContext } from '../../shared-ui/initUIContext.js'\nimport { definedSiteAdaptorsUI } from './define.js'\n\nconst definedSiteAdaptorsResolved = new Map<string, SiteAdaptorUI.Definition>()\n\nexport let activatedSiteAdaptorUI: SiteAdaptorUI.Definition | undefined\nexport let activatedSiteAdaptor_state: Readonly<SiteAdaptorUI.AutonomousState> | undefined\n\nexport async function activateSiteAdaptorUIInner(ui_deferred: SiteAdaptorUI.DeferredDefinition): Promise<void> {\n    assertNotEnvironment(Environment.ManifestBackground)\n\n    console.log('Activating provider', ui_deferred.networkIdentifier)\n\n    const injectSwitchSettings = await Services.Settings.getAllInjectSwitchSettings()\n    if (!injectSwitchSettings[ui_deferred.networkIdentifier]) return\n\n    configureSelectorMissReporter((name) => {\n        const error = new Error(`Selector \"${name}\" does not match anything ${location.href}.`)\n        error.stack = ''\n        Telemetry.captureException(ExceptionType.Error, ExceptionID.Debug, error, {\n            sampleRate: 0.01,\n        })\n    })\n    setupReactShadowRootEnvironment()\n    const ui = (activatedSiteAdaptorUI = await loadSiteAdaptorUI(ui_deferred.networkIdentifier))\n\n    sharedUINetworkIdentifier.value = ui_deferred.networkIdentifier\n    if (ui.customization.sharedComponentOverwrite) {\n        sharedUIComponentOverwrite.value = ui.customization.sharedComponentOverwrite\n    }\n\n    console.log('Provider activated. You can access it by globalThis.ui', ui)\n    setDebugObject('ui', ui)\n\n    const abort = new AbortController()\n    const { signal } = abort\n    if (import.meta.webpackHot) {\n        console.log('Site adaptor HMR enabled.')\n        ui_deferred.hotModuleReload?.(async (newDefinition) => {\n            console.log('Site adaptor updated. Uninstalling current adaptor.')\n            abort.abort()\n            await delay(200)\n            definedSiteAdaptorsResolved.set(ui_deferred.networkIdentifier, newDefinition)\n            activateSiteAdaptorUIInner(ui_deferred)\n        })\n    }\n\n    await waitDocumentReadyState('interactive')\n\n    i18nOverwrite()\n\n    await ui.collecting.themeSettingsProvider?.start(signal)\n\n    activatedSiteAdaptor_state = await ui.init(signal)\n\n    startIntermediateSetupGuide()\n    $unknownIdentityResolution()\n\n    ui.collecting.postsProvider?.start(signal)\n    startPostListener()\n    ui.collecting.currentVisitingIdentityProvider?.start(signal)\n\n    ui.injection.pageInspector?.(signal)\n    ui.injection.toolbox?.(signal, 'wallet')\n    ui.injection.toolbox?.(signal, 'application')\n    ui.injection.newPostComposition?.start?.(signal)\n    ui.injection.searchResult?.(signal)\n    ui.injection.userBadge?.(signal)\n\n    ui.injection.profileTab?.(signal)\n    ui.injection.profileTabContent?.(signal)\n\n    ui.injection.profileCover?.(signal)\n    ui.injection.userAvatar?.(signal)\n    ui.injection.profileAvatar?.(signal)\n    ui.injection.tips?.(signal)\n    ui.injection.lens?.(signal)\n\n    ui.injection.enhancedProfileNFTAvatar?.(signal)\n    ui.injection.openNFTAvatar?.(signal)\n    ui.injection.postAndReplyNFTAvatar?.(signal)\n\n    ui.injection.avatar?.(signal)\n    ui.injection.profileCard?.(signal)\n\n    ui.injection.switchLogo?.(signal)\n    ui.injection.PluginSettingsDialog?.(signal)\n    ui.injection.calendar?.(signal)\n\n    // Update user avatar\n    ui.collecting.currentVisitingIdentityProvider?.recognized.addListener((ref) => {\n        if (!(ref.avatar && ref.identifier)) return\n        Services.Identity.updateProfileInfo(ref.identifier, { avatarURL: ref.avatar, nickname: ref.nickname })\n        const currentProfile = getCurrentIdentifier()\n        if (currentProfile?.linkedPersona) {\n            Services.Identity.createNewRelation(ref.identifier, currentProfile.linkedPersona)\n        }\n    })\n\n    signal.addEventListener('abort', queryRemoteI18NBundle(Services.Helper.queryRemoteI18NBundle))\n\n    const lastRecognizedSub = createSubscriptionFromValueRef(ui.collecting.identityProvider.recognized, signal)\n    const currentVisitingSub = createSubscriptionFromValueRef(\n        ui.collecting.currentVisitingIdentityProvider.recognized,\n        signal,\n    )\n    const connectPersona = async () => {\n        const currentPersonaIdentifier = await Services.Settings.getCurrentPersonaIdentifier()\n        currentSetupGuideStatus[activatedSiteAdaptorUI!.networkIdentifier].value = stringify({\n            status: SetupGuideStep.FindUsername,\n            persona: currentPersonaIdentifier?.toText(),\n        })\n    }\n\n    setupUIContext()\n    __setSiteAdaptorContext__({\n        lastRecognizedProfile: lastRecognizedSub,\n        currentVisitingProfile: currentVisitingSub,\n        currentNextIDPlatform: ui.configuration.nextIDConfig?.platform,\n        currentPersonaIdentifier: createSubscriptionFromValueRef(currentPersonaIdentifier, signal),\n        getPostURL: ui.utils.getPostURL || (() => null),\n        share: ui.utils.share,\n        getPostIdFromNewPostToast: ui.configuration.nextIDConfig?.getPostIdFromNewPostToast,\n        connectPersona,\n        postMessage: ui.automation?.nativeCompositionDialog?.attachText,\n        getSearchedKeyword: ui.collecting.getSearchedKeyword,\n        getUserIdentity: ui.utils.getUserIdentity,\n    })\n\n    startPluginSiteAdaptor(\n        ui.networkIdentifier,\n        createPluginHost(\n            signal,\n            (id, def, signal): Plugin.SiteAdaptor.SiteAdaptorContext => {\n                return {\n                    setMinimalMode(enabled) {\n                        Services.Settings.setPluginMinimalModeEnabled(id, enabled)\n                    },\n                    ...createSharedContext(id, signal),\n                }\n            },\n            Services.Settings.getPluginMinimalModeEnabled,\n            Services.Helper.hasHostPermission,\n        ),\n    )\n    attachReactTreeWithoutContainer(\n        'Modals',\n        createElement(Modals, {\n            createWallet: () => Services.Helper.openDashboard(DashboardRoutes.CreateMaskWalletForm),\n        } satisfies ModalProps),\n    )\n\n    // TODO: receive the signal\n    if (Flags.sandboxedPluginRuntime) import('./sandboxed-plugin.js')\n\n    function i18nOverwrite() {\n        const i18n = ui.customization.i18nOverwrite || {}\n        for (const namespace of Object.keys(i18n)) {\n            const ns = i18n[namespace]\n            for (const i18nKey of Object.keys(ns)) {\n                const pair = i18n[namespace][i18nKey]\n                for (const language of Object.keys(pair)) {\n                    const value = pair[language]\n                    i18NextInstance.addResource(language, namespace, i18nKey, value)\n                }\n            }\n        }\n    }\n\n    function $unknownIdentityResolution() {\n        const provider = ui.collecting.identityProvider\n        if (!provider) return\n        provider.start(signal)\n        provider.recognized.addListener((newValue, oldValue) => {\n            if (document.visibilityState === 'hidden') return\n            if (newValue.identifier === oldValue.identifier) return\n            if (!newValue.identifier) return\n        })\n        if (provider.hasDeprecatedPlaceholderName) {\n            provider.recognized.addListener((id) => {\n                if (signal.aborted) return\n                if (!id.identifier) return\n                Services.Identity.resolveUnknownLegacyIdentity(id.identifier)\n            })\n        }\n    }\n\n    function startPostListener() {\n        const posts = ui.collecting.postsProvider?.posts\n        if (!posts) return\n        const abortSignals = new WeakMap<object, AbortController>()\n        posts.event.on('set', async (key, value) => {\n            await unmount(key)\n            const abort = new AbortController()\n            signal.addEventListener('abort', () => abort.abort())\n            abortSignals.set(key, abort)\n            const { signal: postSignal } = abort\n            ui.injection.postReplacer?.(postSignal, value)\n            ui.injection.postInspector?.(postSignal, value)\n            ui.injection.postActions?.(postSignal, value)\n            ui.injection.commentComposition?.compositionBox(postSignal, value)\n            ui.injection.commentComposition?.commentInspector(postSignal, value)\n        })\n        posts.event.on('delete', unmount)\n        function unmount(key: object) {\n            if (!abortSignals.has(key)) return\n            abortSignals.get(key)!.abort()\n            // AbortSignal need an event loop\n            // unmount a React root need another one.\n            // let's guess a number that the React root will unmount.\n            return delay(16 * 3)\n        }\n    }\n\n    function startIntermediateSetupGuide() {\n        const network = ui.networkIdentifier\n        const id = currentSetupGuideStatus[network].value\n        let started = false\n        const onStatusUpdate = (id: string) => {\n            const { persona, status }: SetupGuideContext = JSON.parse(id || '{}')\n            if (persona && status && !started) {\n                started = true\n                ui.injection.setupWizard?.(\n                    signal,\n                    ECKeyIdentifier.from(persona).expect(`${persona} should be a valid ECKeyIdentifier`),\n                )\n            }\n        }\n        currentSetupGuideStatus[network].addListener(onStatusUpdate)\n        currentSetupGuideStatus[network].readyPromise.then(onStatusUpdate)\n        onStatusUpdate(id)\n    }\n}\n\nasync function loadSiteAdaptorUI(identifier: string): Promise<SiteAdaptorUI.Definition> {\n    if (definedSiteAdaptorsResolved.has(identifier)) return definedSiteAdaptorsResolved.get(identifier)!\n    const define = definedSiteAdaptorsUI.get(identifier)\n    if (!define) throw new Error('Site adaptor not found')\n    const ui = (await define.load()).default\n    definedSiteAdaptorsResolved.set(identifier, ui)\n    if (import.meta.webpackHot) {\n        define.hotModuleReload?.((ui) => definedSiteAdaptorsResolved.set(identifier, ui))\n    }\n    return ui\n}\n","import { type PersonaIdentifier, type ProfileIdentifier } from '@masknet/shared-base'\nimport { activatedSiteAdaptorUI, activatedSiteAdaptor_state } from '../site-adaptor-infra/index.js'\n\nexport function getCurrentIdentifier():\n    | {\n          identifier: ProfileIdentifier\n          linkedPersona?: PersonaIdentifier\n      }\n    | undefined {\n    const current = activatedSiteAdaptorUI!.collecting.identityProvider?.recognized.value\n\n    return (\n        activatedSiteAdaptor_state!.profiles.value.find((i) => i.identifier === current?.identifier) ||\n        activatedSiteAdaptor_state!.profiles.value[0]\n    )\n}\n","import { createPortal } from 'react-dom'\nimport { noop } from 'lodash-es'\nimport { ShadowRootStyleProvider } from './ShadowRootStyleProvider.js'\nimport { shadowEnvironmentMountingRoots, type WrapJSX } from './ShadowRootSetup.js'\n\nexport interface AttachInShadowRootOptions {\n    /** Root tag. @default \"main\" */\n    tag?: keyof HTMLElementTagNameMap | (() => HTMLDivElement | HTMLSpanElement)\n    /** Used to distinguish multiple React root within a same ShadowRoot */\n    key?: string\n    /** The AbortSignal to stop the render */\n    signal?: AbortSignal\n    /** Defer the tree until the mount point is near visible in the document */\n    untilVisible?: boolean\n}\n\nexport interface ReactRootShadowed {\n    render(jsx: React.ReactNode): void\n    // do not name it as unmount otherwise it might be compatible with ReactDOM's Root interface.\n    destroy(): void\n}\n/**\n * @returns\n * A function that render the JSX in the ShadowRoot with emotion support.\n *\n * This function should be only call once for each config.key.\n */\nexport function attachReactTreeToMountedRoot_noHost(\n    wrapJSX?: WrapJSX,\n): (shadow: ShadowRoot, options?: AttachInShadowRootOptions | undefined) => ReactRootShadowed {\n    return attachReactTreeToMountedRoot.bind(null, wrapJSX)\n}\n\nfunction attachReactTreeToMountedRoot(\n    wrapJSX: WrapJSX,\n    shadow: ShadowRoot,\n    options: AttachInShadowRootOptions = {},\n): ReactRootShadowed {\n    const tag = options.tag || 'main'\n    const key = options.key || 'main'\n\n    if (shadow.querySelector(`.${key}`)) {\n        console.error('Tried to create root in', shadow, 'with key', key, 'which is already used. Skip rendering.')\n        return {\n            destroy: noop,\n            render: noop,\n        }\n    }\n\n    const child = typeof tag === 'function' ? tag() : document.createElement(tag)\n    const container = shadow.appendChild(child)\n    const instanceKey = `${key}(${Math.random().toString(36).slice(2)})`\n    container.classList.add(key)\n\n    const controller = new AbortController()\n    const signal = controller.signal\n\n    function render(jsx: React.ReactNode) {\n        if (signal.aborted) return\n        shadowEnvironmentMountingRoots.set(\n            instanceKey,\n            createPortal(<AttachPointComponent children={jsx} />, container, instanceKey),\n        )\n    }\n\n    signal.addEventListener(\n        'abort',\n        () => {\n            shadowEnvironmentMountingRoots.delete(instanceKey)\n            container.remove()\n        },\n        { signal },\n    )\n    options.signal?.addEventListener('abort', () => controller.abort(), { signal })\n    AttachPointComponent.displayName = `ShadowRootAttachPoint (${key})`\n\n    return {\n        destroy: () => controller.abort(),\n        render: (jsx) => {\n            if (options.untilVisible && !isElementPartiallyInViewport(container)) {\n                observe(container, key, () => render(jsx), signal)\n                return\n            }\n            render(jsx)\n        },\n    }\n    function AttachPointComponent({ children: jsx }: React.PropsWithChildren<{}>) {\n        return ShadowRootStyleProvider({ preventPropagation: true, shadow, children: wrapJSX ? wrapJSX(jsx) : jsx })\n    }\n}\nlet observer: IntersectionObserver\nconst callbacks = new WeakMap<Element, Record<string, () => void>>()\nfunction observe(element: Element, key: string, callback: () => void, signal: AbortSignal) {\n    if (signal.aborted) return\n    observer ||= new IntersectionObserver(\n        (records) => {\n            records\n                .filter((x) => x.isIntersecting)\n                .map((x) => {\n                    const result = callbacks.get(x.target)\n                    callbacks.delete(x.target)\n                    return result!\n                })\n                .filter(Boolean)\n                .flatMap(Object.values)\n                .forEach((f) => f())\n        },\n        // preload the element before it really hits the viewport\n        { root: null, threshold: 0.1, rootMargin: '20px 0px 50px 0px' },\n    )\n\n    observer.observe(element)\n    signal.addEventListener('abort', () => observer.unobserve(element), { signal })\n    callbacks.set(element, { ...callbacks.get(element), [key]: callback })\n}\nfunction isElementPartiallyInViewport(element: Element) {\n    const { top, left, height, width } = element.getBoundingClientRect()\n\n    const { clientHeight, clientWidth } = document.documentElement\n    const vertInView = top <= clientHeight && top + height >= 0\n    const horInView = left <= clientWidth && left + width >= 0\n\n    return vertInView && horInView\n}\n","import { Suspense } from 'react'\nimport { createPortal } from 'react-dom'\nimport { QueryClientProvider } from '@tanstack/react-query'\nimport { ReactQueryDevtools } from '@tanstack/react-query-devtools'\nimport { RootWeb3ContextProvider } from '@masknet/web3-hooks-base'\nimport { DialogStackingProvider } from '@masknet/theme'\nimport { compose, i18NextInstance } from '@masknet/shared-base'\nimport { queryClient } from '@masknet/shared-base-ui'\nimport { I18NextProviderHMR } from '../components/I18NextProviderHMR.js'\n\nexport function SiteUIProvider(children: React.ReactNode) {\n    return compose(\n        // Avoid the crash due to unhandled suspense\n        (children) => <Suspense children={children} />,\n        <MaskUIRoot children={children} />,\n    )\n}\n\nfunction MaskUIRoot({ children }: React.PropsWithChildren<{}>) {\n    return (\n        <DialogStackingProvider hasGlobalBackdrop={false}>\n            <QueryClientProvider client={queryClient}>\n                {process.env.NODE_ENV === 'development'\n                    ? createPortal(\n                          <ReactQueryDevtools position=\"bottom-right\" toggleButtonProps={{ style: { width: 24 } }} />,\n                          document.body,\n                      )\n                    : null}\n                <RootWeb3ContextProvider>\n                    <I18NextProviderHMR i18n={i18NextInstance}>{children}</I18NextProviderHMR>\n                </RootWeb3ContextProvider>\n            </QueryClientProvider>\n        </DialogStackingProvider>\n    )\n}\n","import { useRef } from 'react'\nimport { type Theme, unstable_createMuiStrictModeTheme } from '@mui/material'\nimport { MaskDarkTheme, MaskLightTheme } from '@masknet/theme'\nimport { languageSettings } from '@masknet/shared-base'\nimport { useValueRef } from '@masknet/shared-base-ui'\nimport { ThemeMode } from '@masknet/web3-shared-base'\nimport { useThemeLanguage } from '../../shared-ui/hooks/useThemeLanguage.js'\nimport { activatedSiteAdaptorUI } from '../site-adaptor-infra/index.js'\nimport { useThemeSettings } from './DataSource/useActivatedUI.js'\n\nconst defaultUseTheme = (t: Theme) => t\n\nexport function useMaskSiteAdaptorMixedTheme() {\n    const { mode } = useThemeSettings()\n    const useMixedTheme = useRef(activatedSiteAdaptorUI!.customization.useTheme || defaultUseTheme).current\n\n    const [localization] = useThemeLanguage(useValueRef(languageSettings))\n    const theme = unstable_createMuiStrictModeTheme(\n        mode === ThemeMode.Dark ? MaskDarkTheme : MaskLightTheme,\n        localization,\n    )\n    return useMixedTheme(theme)\n}\n","import { Suspense } from 'react'\nimport { useSiteThemeMode } from '@masknet/plugin-infra/content-script'\nimport { SharedContextProvider } from '@masknet/shared'\nimport { CSSVariableInjector, MaskThemeProvider } from '@masknet/theme'\nimport { ErrorBoundary } from '@masknet/shared-base-ui'\nimport { Sniffings, compose } from '@masknet/shared-base'\nimport { useMaskSiteAdaptorMixedTheme } from '../../components/useMaskSiteAdaptorMixedTheme.js'\n\nexport function ShadowRootAttachPointRoot(children: React.ReactNode) {\n    return compose(\n        (children) => <Suspense children={children} />,\n        (children) => <ErrorBoundary children={children} />,\n        (children) =>\n            MaskThemeProvider({\n                useMaskIconPalette: useSiteThemeMode,\n                useTheme: useMaskSiteAdaptorMixedTheme,\n                CustomSnackbarOffsetY: Sniffings.is_facebook_page ? 80 : undefined,\n                children,\n            }),\n        (children) => SharedContextProvider({ children }),\n        <>\n            <CSSVariableInjector />\n            {children}\n        </>,\n    )\n}\n","import { createPortal } from 'react-dom'\nimport {\n    attachReactTreeToMountedRoot_noHost,\n    setupReactShadowRootEnvironment as setupReactShadowRootEnvironmentUpper,\n    CSSVariableInjector,\n    usePortalShadowRoot,\n} from '@masknet/theme'\nimport { Flags } from '@masknet/flags'\nimport { SiteUIProvider } from '@masknet/shared'\nimport { ShadowRootAttachPointRoot } from './ShadowRootAttachPointRoot.js'\n\nconst captureEvents: Array<keyof HTMLElementEventMap> = [\n    'paste',\n    'keydown',\n    'keypress',\n    'keyup',\n    'drag',\n    'dragend',\n    'dragenter',\n    'dragleave',\n    'dragover',\n    'dragstart',\n    'change',\n]\nexport function setupReactShadowRootEnvironment() {\n    const shadow = setupReactShadowRootEnvironmentUpper(Flags.shadowRootInit, captureEvents, SiteUIProvider)\n    // Inject variable for Portals\n    attachReactTreeWithContainer(shadow, { key: 'css-vars' }).render(\n        <>\n            <CSSVariableInjector />\n        </>,\n    )\n}\n\nexport const attachReactTreeWithContainer = attachReactTreeToMountedRoot_noHost(ShadowRootAttachPointRoot)\n\nfunction AttachReactTreeWithoutContainerRedirect(props: React.PropsWithChildren<{ debugKey: string }>) {\n    // Note: since it is the direct children of attachReactTreeWithoutContainer, it MUST inside a ShadowRoot environment.\n    return usePortalShadowRoot((container) => createPortal(props.children, container!), props.debugKey)\n}\n/**\n * @param debugKey Only used for debug\n * @param jsx JSX to render\n * @param signal AbortSignal\n */\nexport function attachReactTreeWithoutContainer(debugKey: string, jsx: React.ReactNode, signal?: AbortSignal) {\n    // Note: do not attach this DOM to window. We don't need it\n    const dom = document.createElement('main')\n    const shadow = dom.attachShadow({ mode: 'closed', delegatesFocus: true })\n\n    attachReactTreeWithContainer(shadow, { signal, key: debugKey }).render(\n        <AttachReactTreeWithoutContainerRedirect children={jsx} debugKey={debugKey} />,\n    )\n}\n","import type { MutationObserverWatcher } from '@dimensiondev/holoflows-kit'\nimport { Flags } from '@masknet/flags'\n\n/**\n * @example\n * ```ts\n * startWatch(new MutationObserverWatcher(ls), {\n *    signal,\n *    missingReportRule: new URL('https://twitter.com/'),\n *    name: 'twitter-home-page',\n * })\n * ```\n *\n * This will be reported only when the current page is https://twitter.com/ and no matches is found.\n */\nexport function startWatch<T extends MutationObserverWatcher<any, any, any, any>>(watcher: T, options: WatchOptions): T\nexport function startWatch<T extends MutationObserverWatcher<any, any, any, any>>(watcher: T, options: AbortSignal): T\nexport function startWatch<T extends MutationObserverWatcher<any, any, any, any>>(\n    watcher: T,\n    options: AbortSignal | WatchOptions,\n) {\n    if (options instanceof AbortSignal) {\n        options = { signal: options }\n    }\n    const { signal, missingReportRule, shadowRootDelegatesFocus: delegatesFocus } = options\n\n    if (missingReportRule) {\n        watchers.set(watcher, missingReportRule)\n        const timeout = setTimeout(check, 2000)\n        signal.addEventListener(\n            'abort',\n            () => {\n                watchers.delete(watcher)\n                clearTimeout(timeout)\n            },\n            { once: true },\n        )\n    }\n\n    watcher\n        .setDOMProxyOption({\n            afterShadowRootInit: { ...Flags.shadowRootInit, delegatesFocus },\n            beforeShadowRootInit: { ...Flags.shadowRootInit, delegatesFocus },\n        })\n        .startWatch({ subtree: true, childList: true }, signal)\n    return watcher\n}\n/**\n * string will be startsWith match, RegExp will be partial match\n */\ntype MissingReportRuleBasic = string | RegExp\ntype MissingReportRule = MissingReportRuleBasic | MissingReportRuleBasic[] | (() => boolean | Promise<boolean>)\n\ninterface MissingReportRuleOptions {\n    name: string\n    rule: MissingReportRule\n}\n\nexport interface WatchOptions {\n    signal: AbortSignal\n    missingReportRule?: MissingReportRuleOptions\n    shadowRootDelegatesFocus?: boolean\n}\n\nconst watchers = new Map<MutationObserverWatcher<any>, MissingReportRuleOptions>()\nif (typeof window === 'object') {\n    window.addEventListener('locationchange', () => {\n        setTimeout(check, 2000)\n    })\n}\nlet reporter: (name: string) => void = function (name: string) {\n    console.warn(`[Mask] Watcher \"${name}\" expected to match something but it didn't.`, location.href)\n}\nexport function configureSelectorMissReporter(newReporter: typeof reporter) {\n    reporter = newReporter\n}\nfunction check() {\n    for (const [watcher, { name, rule }] of watchers) {\n        // protected API\n        // eslint-disable-next-line @typescript-eslint/dot-notation\n        if (watcher['lastKeyList'].length) continue\n        if (typeof rule === 'function') {\n            const result = rule()\n            if (!result) continue\n            if (result !== true) {\n                // eslint-disable-next-line @typescript-eslint/no-loop-func\n                result.then((x) => x || reporter?.(name))\n                continue\n            }\n        } else if (Array.isArray(rule)) {\n            if (!rule.some(hitBasic)) continue\n        } else if (!hitBasic(rule)) continue\n\n        reporter(name)\n    }\n}\nfunction hitBasic(rule: MissingReportRuleBasic) {\n    if (rule instanceof RegExp) {\n        return rule.test(location.href)\n    }\n    return location.href.startsWith(rule)\n}\n","import { isEqual } from 'lodash-es'\nimport { ALL_EVENTS } from '@servie/events'\nimport { ValueRefWithReady } from '@masknet/shared-base'\nimport { useValueRef } from '@masknet/shared-base-ui'\nimport { createManager } from './manage.js'\nimport type { Plugin } from '../types.js'\n\nconst { activated, startDaemon, events, minimalMode } = createManager(\n    (def) => def.ExtensionPage,\n    createManager.NoManagedContext,\n)\n\nconst activatedSub = new ValueRefWithReady<Plugin.ExtensionPage.Definition[]>([], isEqual)\nevents.on(ALL_EVENTS, () => (activatedSub.value = [...activated.plugins]))\n\nconst minimalModeSub = new ValueRefWithReady<string[]>([], isEqual)\nevents.on('minimalModeChanged', () => (minimalModeSub.value = [...minimalMode]))\n\nexport function useIsMinimalModeExtensionPage(pluginID: string) {\n    return useValueRef(minimalModeSub).includes(pluginID)\n}\n\nexport function useActivatedPluginsExtensionPage() {\n    return useValueRef(activatedSub)\n}\n\nexport function useActivatedPluginExtensionPage(pluginID: string) {\n    const plugins = useValueRef(activatedSub)\n    return plugins.find((x) => x.ID === pluginID)\n}\n\nexport function startPluginHostExtensionPage(\n    host: Plugin.__Host.Host<Plugin.ExtensionPage.Definition, Plugin.ExtensionPage.ExtensionPageContext>,\n) {\n    startDaemon(host)\n}\n","import { useMemo } from 'react'\nimport { isEqual } from 'lodash-es'\nimport { unreachable } from '@masknet/kit'\nimport { useValueRef } from '@masknet/shared-base-ui'\nimport { type EnhanceableSite, ValueRefWithReady } from '@masknet/shared-base'\nimport { createManager } from './manage.js'\nimport { getPluginDefine } from './store.js'\nimport type { Plugin } from '../types.js'\n\nconst { events, activated, startDaemon, minimalMode } = createManager(\n    (def) => def.SiteAdaptor,\n    createManager.NoManagedContext,\n)\nconst activatedSub = new ValueRefWithReady<Plugin.SiteAdaptor.Definition[]>([], isEqual)\nevents.on('activateChanged', () => (activatedSub.value = [...activated.plugins]))\n\nconst minimalModeSub = new ValueRefWithReady<string[]>([], isEqual)\nevents.on('minimalModeChanged', () => (minimalModeSub.value = [...minimalMode]))\n\nexport function useActivatedPluginsSiteAdaptor(minimalModeEqualsTo: 'any' | boolean) {\n    const minimalMode = useValueRef(minimalModeSub)\n    const result = useValueRef(activatedSub)\n    return useMemo(() => {\n        if (minimalModeEqualsTo === 'any') return result\n        else if (minimalModeEqualsTo === true) return result.filter((x) => minimalMode.includes(x.ID))\n        else if (minimalModeEqualsTo === false) return result.filter((x) => !minimalMode.includes(x.ID))\n        unreachable(minimalModeEqualsTo)\n    }, [result, minimalMode, minimalModeEqualsTo])\n}\nuseActivatedPluginsSiteAdaptor.visibility = {\n    useMinimalMode: useActivatedPluginsSiteAdaptor.bind(null, true),\n    useNotMinimalMode: useActivatedPluginsSiteAdaptor.bind(null, false),\n    useAnyMode: useActivatedPluginsSiteAdaptor.bind(null, 'any'),\n}\n\nexport function useIsMinimalMode(pluginID: string) {\n    return useValueRef(minimalModeSub).includes(pluginID)\n}\n\n/**\n *\n * @param pluginID Get the plugin ID\n * @param visibility Should invisible plugin included?\n * @returns\n */\nexport function useActivatedPluginSiteAdaptor(pluginID: string, minimalModeEqualsTo: 'any' | boolean) {\n    const plugins = useActivatedPluginsSiteAdaptor(minimalModeEqualsTo)\n    const minimalMode = useValueRef(minimalModeSub)\n\n    return useMemo(() => {\n        const result = plugins.find((x) => x.ID === pluginID)\n        if (!result) return result\n        if (minimalModeEqualsTo === 'any') return result\n        else if (minimalModeEqualsTo === true) {\n            if (minimalMode.includes(result.ID)) return result\n            return undefined\n        } else if (minimalModeEqualsTo === false) {\n            if (minimalMode.includes(result.ID)) return undefined\n            return result\n        }\n        unreachable(minimalModeEqualsTo)\n    }, [pluginID, plugins, minimalMode, minimalModeEqualsTo])\n}\n\nexport function startPluginSiteAdaptor(\n    currentNetwork: EnhanceableSite,\n    host: Plugin.__Host.Host<Plugin.SiteAdaptor.Definition, Plugin.SiteAdaptor.SiteAdaptorContext>,\n) {\n    startDaemon(host, (id) => {\n        const def = getPluginDefine(id)\n        if (!def) return false\n\n        const status = def.enableRequirement.supports.sites[currentNetwork]\n        if (def.enableRequirement.supports.type === 'opt-in' && status !== true) return false\n        if (def.enableRequirement.supports.type === 'opt-out' && status === true) return false\n        return true\n    })\n}\n","// This file will be virtualized in the future.\n// Currently all plugins access the same value, but we can virtualize them in the future.\n\nimport type { Subscription } from 'use-subscription'\nimport type { IdentityResolved } from '../types.js'\nimport type { NextIDPlatform, PersonaIdentifier, PostIdentifier } from '@masknet/shared-base'\n\nexport interface __SiteAdaptorContext__ {\n    lastRecognizedProfile: Subscription<IdentityResolved | undefined>\n    currentVisitingProfile: Subscription<IdentityResolved | undefined>\n    currentNextIDPlatform: NextIDPlatform | undefined\n    currentPersonaIdentifier: Subscription<PersonaIdentifier | undefined>\n    getPostURL: (identifier: PostIdentifier) => URL | null\n    share: undefined | ((text: string) => void)\n    getUserIdentity: ((useId: string) => Promise<IdentityResolved | undefined>) | undefined\n    getPostIdFromNewPostToast: (() => string) | undefined\n    postMessage: ((text: string, options?: any) => Promise<void>) | undefined\n    getSearchedKeyword: (() => string) | undefined\n    connectPersona: () => Promise<void>\n}\nexport let lastRecognizedProfile: __SiteAdaptorContext__['lastRecognizedProfile']\nexport let currentVisitingProfile: __SiteAdaptorContext__['currentVisitingProfile']\nexport let currentNextIDPlatform: NextIDPlatform | undefined\nexport let currentPersonaIdentifier: __SiteAdaptorContext__['currentPersonaIdentifier']\nexport let getPostURL: __SiteAdaptorContext__['getPostURL']\nexport let share: __SiteAdaptorContext__['share']\nexport let getUserIdentity: __SiteAdaptorContext__['getUserIdentity']\nexport let getPostIdFromNewPostToast: __SiteAdaptorContext__['getPostIdFromNewPostToast']\nexport let postMessage: __SiteAdaptorContext__['postMessage']\nexport let getSearchedKeyword: __SiteAdaptorContext__['getSearchedKeyword']\nexport let connectPersona: __SiteAdaptorContext__['connectPersona']\nexport function __setSiteAdaptorContext__(value: __SiteAdaptorContext__) {\n    ;({\n        lastRecognizedProfile,\n        currentVisitingProfile,\n        currentNextIDPlatform,\n        currentPersonaIdentifier,\n        getPostURL,\n        share,\n        getUserIdentity,\n        getPostIdFromNewPostToast,\n        postMessage,\n        getSearchedKeyword,\n        connectPersona,\n    } = value)\n}\n","import type { Theme } from '@mui/material'\nimport { getBackgroundColor } from '../utils/theme/color-tools.js'\n\nexport function useSiteThemeMode(theme: Theme) {\n    const backgroundColor = getBackgroundColor(document.body)\n    const isDark = theme.palette.mode === 'dark'\n    const isDarker = backgroundColor === 'rgb(0,0,0)'\n\n    return isDark ? (!isDarker ? 'dim' : 'dark') : 'light'\n}\n","import { clamp } from 'lodash-es'\n\ntype RGB = [number, number, number]\ntype RGBA = [number, number, number, number]\n\nexport function isDark([r, g, b]: RGB) {\n    return r < 68 && g < 68 && b < 68\n}\n\nexport function toRGB(channels: RGB | undefined) {\n    if (!channels) return ''\n    return `rgb(${channels.join(',')})`\n}\n\nexport function fromRGB(rgb: string): RGB | undefined {\n    const matched = rgb.match(/rgb\\(\\s*(\\d+?)\\s*,\\s*(\\d+?)\\s*,\\s*(\\d+?)\\s*\\)/)\n    if (matched) {\n        const [_, r, g, b] = matched\n        return [Number.parseInt(r, 10), Number.parseInt(g, 10), Number.parseInt(b, 10)]\n    }\n    return\n}\n\nexport function shade(channels: RGB, percentage: number): RGB {\n    return channels.map((c) => clamp(Math.floor((c * (100 + percentage)) / 100), 0, 255)) as RGB\n}\n\nfunction fromRGBAtoRGB(color: string): string {\n    const matched = color.match(/^rgba\\((\\d{1,3}%?),\\s*(\\d{1,3}%?),\\s*(\\d{1,3}%?),\\s*(\\d*(?:\\.\\d+)?)\\)$/)\n    if (matched) {\n        const [_, r, g, b, a] = matched\n        const rgba: RGBA = [\n            Number.parseInt(r, 10),\n            Number.parseInt(g, 10),\n            Number.parseInt(b, 10),\n            Number.parseInt(a, 10),\n        ]\n\n        return toRGB(shade(rgba.slice(0, 3) as RGB, rgba[3] * 100))\n    }\n\n    return ''\n}\n\nfunction isRGBA(color: string) {\n    return color.match(/^rgba\\((\\d{1,3}%?),\\s*(\\d{1,3}%?),\\s*(\\d{1,3}%?),\\s*(\\d*(?:\\.\\d+)?)\\)$/)\n}\n\nexport function getBackgroundColor(element: HTMLElement | HTMLBodyElement | undefined) {\n    if (!element) return ''\n    const color = getComputedStyle(element).backgroundColor\n    if (isRGBA(color)) {\n        return fromRGBAtoRGB(color)\n    }\n    return color ? toRGB(fromRGB(color)) : ''\n}\n","import { isEqual } from 'lodash-es'\nimport { Appearance, LanguageOptions } from '@masknet/public-api'\nimport { createGlobalSettings, createBulkSettings } from './createSettings.js'\nimport { updateLanguage } from '../i18n/index.js'\nimport { BooleanPreference } from '../types.js'\nimport { NetworkPluginID, PluginID } from '../types/PluginID.js'\nimport { LockStatus } from '../types/Wallet.js'\nimport { EnhanceableSite, ExtensionSite } from '../Site/types.js'\nimport { SwitchLogoType } from '../types/SwitchLogo.js'\nimport { ValueRefWithReady, type PersonaIdentifier, ECKeyIdentifier } from '../index.js'\n\nexport const languageSettings = createGlobalSettings<LanguageOptions>('language', LanguageOptions.__auto__)\nlanguageSettings.addListener(updateLanguage)\n\nexport const pluginIDsSettings = createGlobalSettings<Record<EnhanceableSite | ExtensionSite, NetworkPluginID>>(\n    'PluginIdBySite',\n    {\n        [EnhanceableSite.Twitter]: NetworkPluginID.PLUGIN_EVM,\n        [EnhanceableSite.Facebook]: NetworkPluginID.PLUGIN_EVM,\n        [EnhanceableSite.Instagram]: NetworkPluginID.PLUGIN_EVM,\n        [EnhanceableSite.OpenSea]: NetworkPluginID.PLUGIN_EVM,\n        [EnhanceableSite.Minds]: NetworkPluginID.PLUGIN_EVM,\n        [EnhanceableSite.Localhost]: NetworkPluginID.PLUGIN_EVM,\n        [EnhanceableSite.Mirror]: NetworkPluginID.PLUGIN_EVM,\n        [EnhanceableSite.App]: NetworkPluginID.PLUGIN_EVM,\n        [ExtensionSite.Popup]: NetworkPluginID.PLUGIN_EVM,\n        [ExtensionSite.Dashboard]: NetworkPluginID.PLUGIN_EVM,\n    },\n    isEqual,\n)\n\nexport const InjectSwitchSettings = createBulkSettings<boolean>('InjectSwitchBySite', true)\n\nexport const currentMaskWalletLockStatusSettings = createGlobalSettings<LockStatus>(\n    `${PluginID.Wallet}+maskWalletLockStatus`,\n    LockStatus.INIT,\n)\n\nexport const currentSetupGuideStatus = createBulkSettings('currentSetupGuideStatus', '')\nexport const userGuideStatus = createBulkSettings('userGuideStatus', '')\nexport const userGuideFinished = createBulkSettings('userGuideFinished', false)\nexport const sayHelloShowed = createBulkSettings('sayHelloShowed', false)\nexport const userPinExtension = createGlobalSettings('userPinExtension', false)\nexport const dismissVerifyNextID = createBulkSettings<Record<string, boolean>>('dismissVerifyNextID', {}, isEqual)\nexport const decentralizedSearchSettings = createGlobalSettings('decentralizedSearchSettings', true)\nexport const appearanceSettings = createGlobalSettings<Appearance>('appearance', Appearance.default)\n\n/**\n * ! DO NOT use this directly to query the plugin status !\n *\n * use `useActivatedPluginsSiteAdaptor().find((x) => x.ID === PLUGIN_ID)` or\n * `useActivatedPluginsExtensionPage().find((x) => x.ID === PLUGIN_ID)` instead\n * @deprecated DO NOT EXPORT THIS\n */\n// This was \"currentPluginEnabled\" before, but we used it to represent minimal mode now to make the settings be able to migrate.\nconst pluginMinimalModeReversed = createBulkSettings<boolean | 'enabled'>('pluginsEnabled', true)\nexport function getCurrentPluginMinimalMode(id: string) {\n    if (pluginMinimalModeReversed['plugin:' + id].value === 'enabled') return BooleanPreference.False\n    if (pluginMinimalModeReversed['plugin:' + id].value === false) return BooleanPreference.True\n    return BooleanPreference.Default\n}\nexport function setCurrentPluginMinimalMode(id: string, value: BooleanPreference) {\n    if (value === BooleanPreference.Default) pluginMinimalModeReversed['plugin:' + id].value = true\n    else if (value === BooleanPreference.True) pluginMinimalModeReversed['plugin:' + id].value = false\n    else if (value === BooleanPreference.False) pluginMinimalModeReversed['plugin:' + id].value = 'enabled'\n}\nexport const currentPersonaIdentifier = new ValueRefWithReady<PersonaIdentifier | undefined>(undefined)\n{\n    const currentPersonaIdentifier_raw = createGlobalSettings('currentPersonaIdentifier', '')\n    currentPersonaIdentifier.addListener((newVal) => {\n        currentPersonaIdentifier_raw.value = newVal?.toText() ?? ''\n    })\n    currentPersonaIdentifier_raw.addListener((newVal) => {\n        currentPersonaIdentifier.value = newVal ? ECKeyIdentifier.from(newVal).unwrap() : undefined\n    })\n    currentPersonaIdentifier_raw.readyPromise.then(() => {\n        const value = currentPersonaIdentifier_raw.value\n        currentPersonaIdentifier.value = value ? ECKeyIdentifier.from(value).unwrap() : undefined\n    })\n}\n\ntry {\n    // Migrate language settings\n    const lng: string = languageSettings.value\n    if (lng === 'en') languageSettings.value = LanguageOptions.enUS\n    else if (lng === 'zh') languageSettings.value = LanguageOptions.zhCN\n    else if (lng === 'ja') languageSettings.value = LanguageOptions.jaJP\n    else if (lng === 'ko') languageSettings.value = LanguageOptions.koKR\n    else languageSettings.value = LanguageOptions.__auto__\n} catch {}\n\nexport const switchLogoSettings = createBulkSettings('SwitchLogo', SwitchLogoType.New)\n","import { Emitter, ALL_EVENTS } from '@servie/events'\nimport { EMPTY_LIST } from '../constants.js'\n\nfunction tick(callback: () => void) {\n    Promise.resolve().then(callback)\n}\n\nexport class ObservableWeakMap<K extends object, V> extends WeakMap<K, V> {\n    readonly ALL_EVENTS: typeof ALL_EVENTS = ALL_EVENTS\n\n    declare __brand: 'Map'\n\n    event = new Emitter<{ delete: [K]; set: [K, V]; [ALL_EVENTS]: [] }>()\n    override delete(key: K) {\n        const _ = super.delete(key)\n        tick(() => this.event.emit('delete', key))\n        return _\n    }\n    override set(key: K, value: V) {\n        const _ = super.set(key, value)\n        tick(() => this.event.emit('set', key, value))\n        return _\n    }\n}\nexport class ObservableMap<K, V> extends Map<K, V> {\n    readonly ALL_EVENTS: typeof ALL_EVENTS = ALL_EVENTS\n\n    declare __brand: 'Map'\n\n    event = new Emitter<{ delete: [K]; set: [K, V]; clear: []; [ALL_EVENTS]: [] }>()\n    private _asValues: V[] | undefined\n    get asValues() {\n        return (this._asValues ??= this.size ? [...this.values()] : EMPTY_LIST)\n    }\n    override clear() {\n        super.clear()\n        this._asValues = undefined\n        tick(() => this.event.emit('clear'))\n    }\n    override delete(key: K) {\n        const _ = super.delete(key)\n        this._asValues = undefined\n        tick(() => this.event.emit('delete', key))\n        return _\n    }\n    override set(key: K, value: V) {\n        const _ = super.set(key, value)\n        this._asValues = undefined\n        tick(() => this.event.emit('set', key, value))\n        this.event.emit('set', key, value)\n        return _\n    }\n}\nexport class ObservableSet<T> extends Set<T> {\n    readonly ALL_EVENTS: typeof ALL_EVENTS = ALL_EVENTS\n    declare __brand: 'ObservableSet'\n\n    event = new Emitter<{ delete: [T]; add: [T[]]; clear: []; [ALL_EVENTS]: [] }>()\n    private _asValues: T[] | undefined\n    get asValues() {\n        return (this._asValues ??= this.size ? [...this.values()] : EMPTY_LIST)\n    }\n    override clear() {\n        super.clear()\n        this._asValues = undefined\n        tick(() => this.event.emit('clear'))\n    }\n    override delete(key: T) {\n        const _ = super.delete(key)\n        this._asValues = undefined\n        tick(() => this.event.emit('delete', key))\n        return _\n    }\n    override add(...value: T[]) {\n        value.forEach((x) => super.add(x))\n        this._asValues = undefined\n        this.event.emit('add', value)\n        tick(() => this.event.emit('add', value))\n        return this\n    }\n}\n","export interface SetupGuideContext {\n    /** The persona to be connected */\n    persona?: string\n    /**\n     * The user name given by user\n     * @todo Rename to userId\n     * */\n    username?: string\n    /** The WIP step */\n    status?: SetupGuideStep\n    /** Specified tab id to activate setup guide */\n    tabId?: string\n}\n\nexport enum SetupGuideStep {\n    FindUsername = 'find-username',\n    CheckConnection = 'check-connection',\n    VerifyOnNextID = 'next-id-verify',\n    PinExtension = 'pin-extension',\n    Close = 'close',\n}\n","import type { PaletteMode } from '@mui/material'\nimport { kebabCase } from 'lodash-es'\nimport { LightColor, DarkColor } from './constants.js'\nimport tinyColor from 'tinycolor2'\n\n// Fragment are in the form of \"1, 2, 3\"\n// which is used for rgba(var(--x), alpha)\nfunction getRGBFragment(x: Record<string, string>, key: string) {\n    const { r, g, b } = tinyColor(x[key]).toRgb()\n    return [r, g, b].join(', ')\n}\nexport function CSSVariableInjectorCSS(scheme: PaletteMode) {\n    const ns: Record<string, string> = scheme === 'light' ? LightColor : DarkColor\n    const result: Record<string, string> = {}\n    for (const key of Object.keys(ns)) {\n        // --mask-name: val;\n        result[`--mask-${kebabCase(key)}`] = ns[key]\n        result[`--mask-${kebabCase(key)}-fragment`] = getRGBFragment(ns, key)\n    }\n    return {\n        ':root, :host': result,\n        // TODO doesn't work on components that mounted in portal\n        '[data-hide-scrollbar]': {\n            '&::-webkit-scrollbar': {\n                display: 'none',\n            },\n        },\n    }\n}\n\nexport function applyMaskColorVars(node: HTMLElement, scheme: PaletteMode) {\n    const ns: Record<string, string> = scheme === 'light' ? LightColor : DarkColor\n    if (node === document.body) {\n        const id = '#mask-style-var'\n        if (!document.getElementById(id)) {\n            const style = document.createElement('style')\n            style.id = id\n            document.head.appendChild(style)\n        }\n        applyMaskColorVars(document.getElementById(id)!, scheme)\n        return\n    } else if (node instanceof HTMLStyleElement) {\n        let rule = ':root, :host {\\n'\n        for (const key of Object.keys(ns)) {\n            // --mask-name: val;\n            rule += `    --mask-${kebabCase(key)}: ${ns[key]};\\n`\n            rule += `    --mask-${kebabCase(key)}-fragment: ${getRGBFragment(ns, key)};\\n`\n        }\n        node.textContent = rule + '}'\n    } else {\n        for (const key of Object.keys(ns)) {\n            node.style.setProperty('--mask-' + kebabCase(key), ns[key])\n            node.style.setProperty('--mask-' + kebabCase(key) + '-fragment', getRGBFragment(ns, key))\n        }\n    }\n}\n","import { ObservableMap } from '@masknet/shared-base'\nimport { StrictMode, useEffect, useState } from 'react'\nimport { createRoot } from 'react-dom/client'\nimport { PreventShadowRootEventPropagationListContext } from './Contexts.js'\n\n/**\n * This container is used to attach the single React root.\n * It does not contain direct DOM decedents.\n * All decedents are mounted via <Portal>.\n */\nlet globalContainer: HTMLElement\n/**\n * This container is prepared for all the Modals.\n */\nlet portalContainer: ShadowRoot\nexport type WrapJSX = ((jsx: React.ReactNode) => JSX.Element) | undefined\n/** @internal */\nexport const shadowEnvironmentMountingRoots = new ObservableMap<any, JSX.Element>()\n\nexport function setupReactShadowRootEnvironment(\n    init: ShadowRootInit,\n    preventEventPropagationList: Array<keyof HTMLElementEventMap>,\n    wrapJSX?: WrapJSX,\n) {\n    if (portalContainer) return portalContainer\n    // TODO: make sure globalContainer is the last DOM in the body?\n    globalContainer = document.body.appendChild(document.createElement('div'))\n    portalContainer = globalContainer.attachShadow(init)\n\n    // Note: This React Root does not expect to have any direct DOM children.\n    createRoot(globalContainer).render(\n        <StrictMode>\n            <MountingPoint wrapJSX={wrapJSX} preventPropagationList={preventEventPropagationList} />\n        </StrictMode>,\n    )\n    return portalContainer\n}\nfunction MountingPoint(props: { wrapJSX: WrapJSX; preventPropagationList: Array<keyof HTMLElementEventMap> }) {\n    const [children, setChildren] = useState<JSX.Element[]>([])\n    useEffect(() => {\n        shadowEnvironmentMountingRoots.event.on(shadowEnvironmentMountingRoots.ALL_EVENTS, () => {\n            setChildren(Array.from(shadowEnvironmentMountingRoots.values()))\n        })\n    }, [])\n    return (\n        <PreventShadowRootEventPropagationListContext.Provider value={props.preventPropagationList}>\n            {props.wrapJSX ? props.wrapJSX(children) : children}\n        </PreventShadowRootEventPropagationListContext.Provider>\n    )\n}\n\n/** @internal */\nexport const ref = {\n    get portalContainer(): Element | ShadowRoot {\n        let dom: Element | ShadowRoot\n        if (location.protocol.includes('extension')) dom = document.body\n        else if (globalThis.location.hostname === 'localhost') return document.body\n        else if (!portalContainer) throw new TypeError('Please call setupPortalShadowRoot first')\n        else dom = portalContainer\n\n        Object.defineProperty(ref, 'mountingPoint', { value: dom })\n        return dom\n    },\n}\n","import { type DependencyList, useState } from 'react'\nimport { useAsyncRetry, useTimeoutFn } from 'react-use'\nimport type { AsyncStateRetry } from 'react-use/lib/useAsyncRetry.js'\nimport type { NetworkPluginID } from '@masknet/shared-base'\nimport { useChainContext } from './useContext.js'\nimport { useWeb3Others } from './useWeb3Others.js'\n\nconst DEFAULT_SINGLE_BLOCK_DELAY = 10 * 1000 // 10 seconds\nconst DEFAULT_DOUBLE_BLOCK_DELAY = DEFAULT_SINGLE_BLOCK_DELAY * 2\n\nexport function useBeat(delay = 1000) {\n    const [beat, setBeat] = useState(0)\n    const [, , reset] = useTimeoutFn(() => {\n        setBeat((x) => (x + 1) % Number.MAX_SAFE_INTEGER)\n        reset()\n    }, delay)\n    return beat\n}\n\n/**\n * @deprecated Use react-query with refetchInterval\n */\nexport function useBeatRetry<T>(fn: () => Promise<T>, delay = 1000, deps: DependencyList = []): AsyncStateRetry<T> {\n    const beat = useBeat(delay)\n    return useAsyncRetry(fn, deps.concat(beat))\n}\n\nexport function useSingleBlockBeatRetry<T extends NetworkPluginID, R>(\n    pluginID: T,\n    fn: () => Promise<R>,\n    deps: DependencyList = [],\n): AsyncStateRetry<R> {\n    const { chainId } = useChainContext()\n    const Others = useWeb3Others(pluginID)\n    return useBeatRetry(fn, Others.getAverageBlockDelay?.(chainId) ?? DEFAULT_SINGLE_BLOCK_DELAY, deps)\n}\n\nexport function useDoubleBlockBeatRetry<T extends NetworkPluginID, R>(\n    pluginID: T,\n    fn: () => Promise<R>,\n    deps: DependencyList = [],\n): AsyncStateRetry<R> {\n    const { chainId } = useChainContext()\n    const Others = useWeb3Others(pluginID)\n    return useBeatRetry(fn, Others.getAverageBlockDelay?.(chainId, 2) ?? DEFAULT_DOUBLE_BLOCK_DELAY, deps)\n}\n\nexport function useCustomBlockBeatRetry<T extends NetworkPluginID, R>(\n    pluginID: T,\n    fn: () => Promise<R>,\n    deps: DependencyList = [],\n    scale = 1,\n): AsyncStateRetry<R> {\n    const { chainId } = useChainContext()\n    const Others = useWeb3Others(pluginID)\n    return useBeatRetry(fn, Others.getAverageBlockDelay?.(chainId, scale) ?? DEFAULT_DOUBLE_BLOCK_DELAY, deps)\n}\n","'use client';\nimport * as React from 'react';\n\nconst IsRestoringContext = /*#__PURE__*/React.createContext(false);\nconst useIsRestoring = () => React.useContext(IsRestoringContext);\nconst IsRestoringProvider = IsRestoringContext.Provider;\n\nexport { IsRestoringProvider, useIsRestoring };\n//# sourceMappingURL=isRestoring.mjs.map\n"],"names":["parser","parseURLs","text","requireProtocol","lib","default","list","map","x","string","filter","y","URL","canParse","decodeArrayBuffer","encodeArrayBuffer","Some","None","__TwitterEncoder","data","__TwitterEncoderText","__TwitterEncoderBinary","replace","replaceAll","encodeURIComponent","TwitterDecoder","raw","newVersion","TwitterDecoderBinary","isSome","TwitterDecoderText","includes","payloadLink","startsWith","link","url","payload","searchParams","get","Uint8Array","endsWith","search","pathname","slice","MaskMessages","ValueRef","useValueRef","NextIDProof","FontSize","ThemeColor","ThemeMode","useQuery","first","isEqual","useEffect","useMemo","useSubscription","Services","activatedSiteAdaptorUI","activatedSiteAdaptor_state","queryPersonaFromDB","identityResolved","identifier","Identity","queryPersonaByProfile","queryPersonasFromNextID","configuration","nextIDConfig","platform","queryAllExistedBindingsByPlatform","userId","CurrentIdentitySubscription","getCurrentValue","all","profiles","value","current","collecting","identityProvider","recognized","defaultIdentityResolved","find","i","subscribe","sub","a","addListener","b","defaults","mode","Light","size","Normal","color","Blue","defaultThemeSettings","useCurrentIdentity","useLastRecognizedIdentity","useCurrentVisitingIdentity","currentVisitingIdentityProvider","useSocialIdentity","identity","result","enabled","queryKey","queryFn","bindings","persona","personaBindings","publicKeyAsHex","toLowerCase","publicKey","hasBinding","length","binding","events","ownProofChanged","on","refetch","useSocialIdentityByUserId","utils","getUserIdentity","networkMode","useThemeSettings","themeSettings","themeSettingsProvider","createElement","stringify","assertNotEnvironment","Environment","delay","waitDocumentReadyState","startPluginSiteAdaptor","__setSiteAdaptorContext__","Modals","sharedUIComponentOverwrite","sharedUINetworkIdentifier","createSubscriptionFromValueRef","currentPersonaIdentifier","currentSetupGuideStatus","DashboardRoutes","ECKeyIdentifier","i18NextInstance","queryRemoteI18NBundle","SetupGuideStep","setDebugObject","Flags","Telemetry","ExceptionID","ExceptionType","createSharedContext","createPluginHost","getCurrentIdentifier","attachReactTreeWithoutContainer","setupReactShadowRootEnvironment","configureSelectorMissReporter","setupUIContext","definedSiteAdaptorsUI","definedSiteAdaptorsResolved","Map","activateSiteAdaptorUIInner","ui_deferred","ManifestBackground","console","log","networkIdentifier","injectSwitchSettings","Settings","getAllInjectSwitchSettings","name","error","Error","location","href","stack","captureException","Debug","sampleRate","ui","loadSiteAdaptorUI","customization","sharedComponentOverwrite","abort","AbortController","signal","webpackHot","hotModuleReload","newDefinition","set","i18nOverwrite","start","init","startIntermediateSetupGuide","$unknownIdentityResolution","postsProvider","startPostListener","injection","pageInspector","toolbox","newPostComposition","searchResult","userBadge","profileTab","profileTabContent","profileCover","userAvatar","profileAvatar","tips","lens","enhancedProfileNFTAvatar","openNFTAvatar","postAndReplyNFTAvatar","avatar","profileCard","switchLogo","PluginSettingsDialog","calendar","ref","updateProfileInfo","avatarURL","nickname","currentProfile","linkedPersona","createNewRelation","addEventListener","Helper","lastRecognizedSub","currentVisitingSub","connectPersona","getCurrentPersonaIdentifier","status","FindUsername","toText","lastRecognizedProfile","currentVisitingProfile","currentNextIDPlatform","getPostURL","share","getPostIdFromNewPostToast","postMessage","automation","nativeCompositionDialog","attachText","getSearchedKeyword","id","def","setMinimalMode","setPluginMinimalModeEnabled","getPluginMinimalModeEnabled","hasHostPermission","createWallet","openDashboard","CreateMaskWalletForm","sandboxedPluginRuntime","i18n","namespace","Object","keys","ns","i18nKey","pair","language","addResource","provider","newValue","oldValue","document","visibilityState","hasDeprecatedPlaceholderName","aborted","resolveUnknownLegacyIdentity","posts","abortSignals","WeakMap","event","key","unmount","postSignal","postReplacer","postInspector","postActions","commentComposition","compositionBox","commentInspector","has","network","started","onStatusUpdate","JSON","parse","setupWizard","from","expect","readyPromise","then","define","load","createPortal","noop","ShadowRootStyleProvider","shadowEnvironmentMountingRoots","attachReactTreeToMountedRoot_noHost","wrapJSX","attachReactTreeToMountedRoot","bind","shadow","options","tag","querySelector","destroy","render","child","container","appendChild","instanceKey","Math","random","toString","classList","add","controller","jsx","AttachPointComponent","children","delete","remove","displayName","untilVisible","isElementPartiallyInViewport","observe","preventPropagation","observer","callbacks","element","callback","IntersectionObserver","records","isIntersecting","target","Boolean","flatMap","values","forEach","f","root","threshold","rootMargin","unobserve","top","left","height","width","getBoundingClientRect","clientHeight","clientWidth","documentElement","vertInView","horInView","Suspense","QueryClientProvider","ReactQueryDevtools","RootWeb3ContextProvider","DialogStackingProvider","compose","queryClient","I18NextProviderHMR","SiteUIProvider","MaskUIRoot","hasGlobalBackdrop","client","process","env","NODE_ENV","position","toggleButtonProps","style","body","useRef","unstable_createMuiStrictModeTheme","MaskDarkTheme","MaskLightTheme","languageSettings","useThemeLanguage","defaultUseTheme","t","useMaskSiteAdaptorMixedTheme","useMixedTheme","useTheme","localization","theme","Dark","useSiteThemeMode","SharedContextProvider","CSSVariableInjector","MaskThemeProvider","ErrorBoundary","Sniffings","ShadowRootAttachPointRoot","useMaskIconPalette","CustomSnackbarOffsetY","is_facebook_page","undefined","setupReactShadowRootEnvironmentUpper","usePortalShadowRoot","captureEvents","shadowRootInit","attachReactTreeWithContainer","AttachReactTreeWithoutContainerRedirect","props","debugKey","dom","attachShadow","delegatesFocus","startWatch","watcher","AbortSignal","missingReportRule","shadowRootDelegatesFocus","watchers","timeout","setTimeout","check","clearTimeout","once","setDOMProxyOption","afterShadowRootInit","beforeShadowRootInit","subtree","childList","window","reporter","warn","newReporter","rule","Array","isArray","some","hitBasic","RegExp","test","ALL_EVENTS","ValueRefWithReady","createManager","activated","startDaemon","minimalMode","ExtensionPage","NoManagedContext","activatedSub","plugins","minimalModeSub","useIsMinimalModeExtensionPage","pluginID","useActivatedPluginsExtensionPage","useActivatedPluginExtensionPage","ID","startPluginHostExtensionPage","host","unreachable","getPluginDefine","SiteAdaptor","useActivatedPluginsSiteAdaptor","minimalModeEqualsTo","visibility","useMinimalMode","useNotMinimalMode","useAnyMode","useIsMinimalMode","useActivatedPluginSiteAdaptor","currentNetwork","enableRequirement","supports","sites","type","getBackgroundColor","backgroundColor","isDark","palette","isDarker","clamp","r","g","toRGB","channels","join","fromRGB","rgb","matched","match","_","Number","parseInt","shade","percentage","c","floor","fromRGBAtoRGB","rgba","isRGBA","getComputedStyle","Appearance","LanguageOptions","createGlobalSettings","createBulkSettings","updateLanguage","BooleanPreference","NetworkPluginID","PluginID","LockStatus","EnhanceableSite","ExtensionSite","SwitchLogoType","__auto__","pluginIDsSettings","Twitter","PLUGIN_EVM","Facebook","Instagram","OpenSea","Minds","Localhost","Mirror","App","Popup","Dashboard","InjectSwitchSettings","currentMaskWalletLockStatusSettings","Wallet","INIT","userGuideStatus","userGuideFinished","sayHelloShowed","userPinExtension","dismissVerifyNextID","decentralizedSearchSettings","appearanceSettings","pluginMinimalModeReversed","getCurrentPluginMinimalMode","False","True","Default","setCurrentPluginMinimalMode","currentPersonaIdentifier_raw","newVal","unwrap","lng","enUS","zhCN","jaJP","koKR","switchLogoSettings","New","Emitter","EMPTY_LIST","tick","Promise","resolve","ObservableWeakMap","emit","ObservableMap","_asValues","asValues","clear","ObservableSet","Set","CheckConnection","VerifyOnNextID","PinExtension","Close","kebabCase","LightColor","DarkColor","tinyColor","getRGBFragment","toRgb","CSSVariableInjectorCSS","scheme","display","applyMaskColorVars","node","getElementById","head","HTMLStyleElement","textContent","setProperty","StrictMode","useState","createRoot","PreventShadowRootEventPropagationListContext","globalContainer","portalContainer","preventEventPropagationList","MountingPoint","preventPropagationList","setChildren","Provider","protocol","globalThis","hostname","TypeError","defineProperty","useAsyncRetry","useTimeoutFn","useChainContext","useWeb3Others","DEFAULT_SINGLE_BLOCK_DELAY","DEFAULT_DOUBLE_BLOCK_DELAY","useBeat","beat","setBeat","reset","MAX_SAFE_INTEGER","useBeatRetry","fn","deps","concat","useSingleBlockBeatRetry","chainId","Others","getAverageBlockDelay","useDoubleBlockBeatRetry","useCustomBlockBeatRetry","scale"],"sourceRoot":"","x_google_ignoreList":[22]}