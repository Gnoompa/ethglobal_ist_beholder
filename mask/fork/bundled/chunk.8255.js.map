{"version":3,"file":"bundled/chunk.8255.js","mappings":"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","sources":["webpack://mask-network/./node_modules/.pnpm/@mui+icons-material@5.10.6_@mui+material@5.10.8_@types+react@18.2.21_react@0.0.0-experimental-0a360642d-20230711/node_modules/@mui/icons-material/esm/ArrowBack.js","webpack://mask-network/./packages/theme/src/Components/Dialogs/DialogTitle.tsx","webpack://mask-network/./packages/theme/src/Components/Dialogs/Dialog.tsx","webpack://mask-network/./packages/sandboxed-plugin-runtime/src/peer-dependencies-dom/index.ts","webpack://mask-network/./packages/sandboxed-plugin-runtime/src/site-adaptor/index.ts","webpack://mask-network/./packages/mask/content-script/site-adaptor-infra/sandboxed-plugin.ts","webpack://mask-network/./node_modules/.pnpm/@mui+styled-engine@5.10.8_@emotion+react@11.11.1_@emotion+styled@11.11.0_react@0.0.0-experimental-0a360642d-20230711/node_modules/@mui/styled-engine/StyledEngineProvider/StyledEngineProvider.js"],"sourcesContent":["import createSvgIcon from './utils/createSvgIcon';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nexport default createSvgIcon( /*#__PURE__*/_jsx(\"path\", {\n  d: \"M20 11H7.83l5.59-5.59L12 4l-8 8 8 8 1.41-1.41L7.83 13H20v-2z\"\n}), 'ArrowBack');","import { DialogTitle, IconButton, Typography, Box, styled } from '@mui/material'\nimport { Close, ArrowBack } from '@mui/icons-material'\nimport { memo } from 'react'\n\nconst Title = styled(DialogTitle)(({ theme }) => ({\n    display: 'flex',\n    alignItems: 'center',\n    padding: `${theme.spacing(1)} ${theme.spacing(3)}`,\n}))\nexport interface MaskDialogTitleProps {\n    children: string\n    onBack?(): void\n    onClose?(): void\n}\nexport const MaskDialogTitle = memo((props: MaskDialogTitleProps) => {\n    const { children, onBack, onClose } = props\n    const backButton = onBack ? (\n        <IconButton size=\"large\" onClick={onBack} edge=\"start\" color=\"inherit\" sx={{ marginRight: '8px' }}>\n            <ArrowBack />\n        </IconButton>\n    ) : null\n    const closeButton = onClose ? (\n        <IconButton size=\"large\" onClick={onClose} edge=\"end\" color=\"inherit\">\n            <Close />\n        </IconButton>\n    ) : null\n    return (\n        <Title>\n            {backButton}\n            <Typography component=\"span\" variant=\"h6\">\n                {children}\n            </Typography>\n            <Box sx={{ flex: 1 }} />\n            {closeButton}\n        </Title>\n    )\n})\n","import { Dialog, DialogActions, DialogContent, type DialogProps } from '@mui/material'\nimport { memo, type ReactNode, useCallback, useState } from 'react'\nimport { usePortalShadowRoot } from '../../ShadowRoot/index.js'\nimport { MaskDialogTitle, type MaskDialogTitleProps } from './DialogTitle.js'\nimport { CrossIsolationMessages } from '@masknet/shared-base'\nimport { useDialogStackActor } from './DialogStack.js'\nexport interface MaskDialogProps\n    extends React.PropsWithChildren<Omit<MaskDialogTitleProps, 'children'>>,\n        Pick<DialogProps, 'fullWidth' | 'maxWidth'> {\n    title: string\n    open: boolean\n    DialogProps?: Omit<DialogProps, 'open'>\n    isOpenFromApplicationBoard?: boolean\n}\n\n/**\n * This component is used to provide a most common dialog practice in Mask design.\n *\n * But all the primitives are tweaked to fit the design\n * Therefore it also OK to not use this component if you need a special one.\n */\nexport const MaskDialog = memo((props: MaskDialogProps) => {\n    const { title, onBack, onClose, open, children, DialogProps, isOpenFromApplicationBoard, ...inferredDialogProps } =\n        props\n    const dialogProps: DialogProps = { onBackdropClick: onClose, onClose, open, ...inferredDialogProps, ...DialogProps }\n    const { extraProps, shouldReplaceExitWithBack, TrackDialogHierarchy } = useDialogStackActor(open)\n    const closeBothCompositionDialog = useCallback(() => {\n        if (isOpenFromApplicationBoard) {\n            CrossIsolationMessages.events.compositionDialogEvent.sendToLocal({\n                open: false,\n                reason: 'popup',\n                options: { isOpenFromApplicationBoard },\n            })\n            CrossIsolationMessages.events.compositionDialogEvent.sendToLocal({\n                open: false,\n                reason: 'timeline',\n                options: { isOpenFromApplicationBoard },\n            })\n        }\n\n        onClose?.()\n    }, [isOpenFromApplicationBoard])\n    return usePortalShadowRoot((container) => (\n        <TrackDialogHierarchy>\n            <Dialog container={container} {...dialogProps} {...extraProps}>\n                {shouldReplaceExitWithBack ? (\n                    // replace onClose with onBack when and only when there is no onBack\n                    <MaskDialogTitle\n                        onBack={onBack || closeBothCompositionDialog}\n                        onClose={onBack ? closeBothCompositionDialog : undefined}\n                        children={title}\n                    />\n                ) : (\n                    <MaskDialogTitle onBack={onBack} onClose={closeBothCompositionDialog} children={title} />\n                )}\n                {children}\n            </Dialog>\n        </TrackDialogHierarchy>\n    ))\n})\n\nexport function useMaskDialog(title: string, content: ReactNode, actions: ReactNode) {\n    const [isOpen, setOpen] = useState(false)\n    const onClose = useCallback(() => setOpen(false), [])\n    return (\n        <MaskDialog onClose={onClose} open={isOpen} title={title}>\n            <DialogContent>{content}</DialogContent>\n            <DialogActions>{actions}</DialogActions>\n        </MaskDialog>\n    )\n}\n","import * as react from 'react'\nimport * as react_jsx_runtime from 'react/jsx-runtime'\nimport * as react_dom from 'react-dom'\nimport { Trans, useTranslation } from 'react-i18next'\nimport * as mui_material from '@mui/material'\nimport { makeStyles, MaskDialog } from '@masknet/theme'\nimport * as masknet_icons from '@masknet/icons/jsx'\nimport type { PluginRuntime } from '../runtime/runtime.js'\n\nexport function addPeerDependenciesDOM(runtime: PluginRuntime) {\n    runtime.addNamespaceModule('react', esModuleInterop(react))\n    runtime.addNamespaceModule('react/jsx-runtime', esModuleInterop(react_jsx_runtime))\n    runtime.addNamespaceModule('react-dom', esModuleInterop(react_dom))\n    runtime.addNamespaceModule('@mui/material', mui_material)\n    runtime.addNamespaceModule('@masknet/theme', { makeStyles, MaskDialog })\n    runtime.addNamespaceModule('@masknet/icons', { Icons: masknet_icons })\n}\n\nfunction esModuleInterop(object: any) {\n    return { default: object, ...object }\n}\n\nfunction createProxy(initValue: (key: string) => any) {\n    function set(key: string) {\n        const value = initValue(key)\n        Object.defineProperty(container, key, { value, configurable: true })\n        return value\n    }\n    const container = {\n        __proto__: new Proxy(\n            { __proto__: null },\n            {\n                get(_, key) {\n                    if (typeof key === 'symbol') return undefined\n                    return set(key)\n                },\n            },\n        ),\n    }\n    return new Proxy(container, {\n        getPrototypeOf: () => null,\n        setPrototypeOf: (_, v) => v === null,\n        getOwnPropertyDescriptor: (_, key) => {\n            if (typeof key === 'symbol') return undefined\n            if (!(key in container)) set(key)\n            return Object.getOwnPropertyDescriptor(container, key)\n        },\n    })\n}\nexport function createI18nHooksAndTranslate(id: string) {\n    return {\n        useI18N() {\n            const { t } = useTranslation(id)\n            return react.useMemo(() => createProxy((key) => t.bind(null, key)), [t])\n        },\n        Translate: createProxy(\n            (key: string) => (props: any) => react.createElement(Trans, { i18nKey: key, ns: id, ...props }),\n        ),\n    }\n}\n","import { PluginRuntime } from '../runtime/runtime.js'\nimport { type BasicHostHooks, type BasicHostInstance, PluginRunner } from '../runtime/runner.js'\nimport { getURL } from '../utils/url.js'\nimport { addPeerDependencies } from '../peer-dependencies/index.js'\nimport { addPeerDependenciesDOM, createI18nHooksAndTranslate } from '../peer-dependencies-dom/index.js'\nimport { AsyncCall, AsyncGeneratorCall } from 'async-call-rpc/full'\nimport { serializer } from '@masknet/shared-base'\nimport { isManifest } from '../utils/manifest.js'\nimport { Children } from 'react'\n\nexport interface SiteAdaptorHostHooks extends BasicHostHooks {\n    attachCompositionMetadata(pluginID: string, metaID: string, meta: unknown): void\n    dropCompositionMetadata(pluginID: string, metaID: string): void\n    closeApplicationBoardDialog(): void\n}\nexport interface SiteAdaptorInstance extends BasicHostInstance {\n    MetadataRender: Map<string, (meta: unknown) => unknown>\n    CompositionEntry:\n        | undefined\n        | { label: React.ReactNode; dialog: React.ComponentType<{ open: boolean; onClose(): void }> }\n    CompositionDialogMetadataBadgeRender(\n        key: string,\n        meta: unknown,\n    ): { text: React.ReactNode; tooltip?: React.ReactNode } | null\n}\nexport class SiteAdaptorPluginHost extends PluginRunner<SiteAdaptorHostHooks, SiteAdaptorInstance> {\n    constructor(\n        hooks: SiteAdaptorHostHooks,\n        allowLocalOverrides: boolean,\n        signal: AbortSignal = new AbortController().signal,\n    ) {\n        super(hooks, allowLocalOverrides, signal)\n    }\n\n    protected async HostStartPlugin(id: string, isLocal: boolean, signal: AbortSignal): Promise<SiteAdaptorInstance> {\n        const manifest = await this.hooks.fetchManifest(id, isLocal)\n        if (!isManifest(manifest)) throw new TypeError(`${id} does not have a valid manifest.`)\n\n        const runtime = new PluginRuntime(id, isLocal ? `local-plugin-${id}` : `plugin-${id}`, {}, signal)\n        addPeerDependencies(runtime)\n        addPeerDependenciesDOM(runtime)\n\n        const { content_script, rpc, rpcGenerator } = manifest.entries || {}\n        const MetadataBadgeRender = new Map()\n        const instance: SiteAdaptorInstance = {\n            id,\n            isLocal,\n            runtime,\n            MetadataRender: new Map(),\n            CompositionEntry: undefined,\n            CompositionDialogMetadataBadgeRender(\n                key: string,\n                meta: unknown,\n            ): null | { text: React.ReactNode; tooltip?: React.ReactNode } {\n                if (!MetadataBadgeRender.has(key)) return null\n                const data = MetadataBadgeRender.get(key)!(meta)\n                if (typeof data !== 'object') throw new TypeError('registerMetadataBadgeRender must return an object.')\n                if (!data) return null\n                if (!('text' in data))\n                    throw new TypeError('registerMetadataBadgeRender must return an object with text.')\n                const { text, tooltip } = data\n                // assert\n                Children.only(text)\n                tooltip && Children.only(tooltip)\n                return { text, tooltip }\n            },\n        }\n        this.bridgeRPC(instance, !!rpc, !!rpcGenerator)\n        runtime.addNamespaceModule('@masknet/plugin/content-script', {\n            attachMetadata: (metaID: string, value: unknown) => {\n                if (typeof metaID !== 'string') throw new TypeError('Metadata key must be a string')\n                if (arguments.length !== 2) throw new TypeError('attachMetadata requires two arguments')\n                this.hooks.attachCompositionMetadata(id, metaID, value)\n            },\n            dropMetadata: (metaID: string) => {\n                if (metaID !== 'string') throw new TypeError('Metadata key must be a string')\n                this.hooks.dropCompositionMetadata(id, metaID)\n            },\n            closeApplicationBoardDialog: () => {\n                this.hooks.closeApplicationBoardDialog()\n            },\n        })\n        runtime.addNamespaceModule('@masknet/plugin/content-script/react', {\n            registerMetadataRender: (metaID: string, render: (meta: unknown) => unknown) => {\n                if (typeof metaID !== 'string') throw new TypeError('Metadata key must be a string')\n                if (typeof render !== 'function') throw new TypeError('Metadata render must be a function')\n                instance.MetadataRender.set(metaID, render)\n            },\n            registerMetadataBadgeRender: (metaID: string, render: (meta: unknown) => unknown) => {\n                if (typeof metaID !== 'string') throw new TypeError('Metadata key must be a string')\n                if (typeof render !== 'function') throw new TypeError('Metadata render must be a function')\n                MetadataBadgeRender.set(metaID, render)\n            },\n            registerCompositionEntry: (label: unknown, dialog: unknown) => {\n                Children.only(label)\n                // label asserted before, dialog leave it to runtime error\n                instance.CompositionEntry = { label: label as any, dialog: dialog as any }\n            },\n        })\n\n        runtime.addNamespaceModule('@masknet/plugin-hooks', {\n            ...createI18nHooksAndTranslate(id),\n            // TODO: implement this\n            // TODO: move this to @masknet/plugin/content-script/react\n            usePluginWrapper: () => void 0,\n        })\n        // TODO: implement this\n        runtime.addNamespaceModule('@masknet/plugin/ui/showSnackbar', {\n            showSnackbar: console.log,\n        })\n        // TODO: implement this\n        runtime.addNamespaceModule('@masknet/plugin/ui/open', {\n            openWindow: console.log,\n        })\n        if (content_script) await runtime.imports(getURL(id, content_script, isLocal))\n        return instance\n    }\n\n    private bridgeRPC(instance: SiteAdaptorInstance, hasRPC: boolean, hasRPCGenerator: boolean) {\n        if (!hasRPC && !hasRPCGenerator) return\n        const { id, runtime } = instance\n\n        const namespace: any = {}\n        if (hasRPC) {\n            namespace.worker = AsyncCall(null, {\n                channel: this.hooks.createRpcChannel(id, this.signal),\n                serializer,\n                log: true,\n                thenable: false,\n            })\n        }\n        if (hasRPCGenerator) {\n            namespace.workerGenerator = AsyncGeneratorCall(null, {\n                channel: this.hooks.createRpcGeneratorChannel(id, this.signal),\n                serializer,\n                log: true,\n                thenable: false,\n            })\n        }\n        runtime.addNamespaceModule('@masknet/plugin/utils/rpc', namespace)\n    }\n}\n","import { Children, createElement } from 'react'\nimport { type SiteAdaptorInstance, SiteAdaptorPluginHost } from '@masknet/sandboxed-plugin-runtime/site-adaptor'\nimport { Flags } from '@masknet/flags'\nimport { type Plugin, registerPlugin } from '@masknet/plugin-infra'\nimport { ApplicationBoardModal } from '@masknet/shared'\nimport type { PluginID } from '@masknet/shared-base'\nimport { hmr } from '../../utils-pure/index.js'\nimport { createHostAPIs } from '../../shared/sandboxed-plugin/host-api.js'\n\nconst { signal } = hmr(import.meta.webpackHot)\nimport.meta.webpackHot?.accept()\n\nlet hot:\n    | Map<\n          string,\n          (\n              hot: Promise<{\n                  default: Plugin.SiteAdaptor.Definition\n              }>,\n          ) => void\n      >\n    | undefined\nif (process.env.NODE_ENV === 'development') {\n    const sym = Symbol.for('sandboxed plugin bridge hot map')\n    hot = (globalThis as any)[sym] ??= new Map()\n}\n\nif (Flags.sandboxedPluginRuntime) {\n    const host = new SiteAdaptorPluginHost(\n        {\n            ...createHostAPIs(false),\n            // TODO: implement this\n            attachCompositionMetadata(plugin, id, meta) {},\n            // TODO: implement this\n            dropCompositionMetadata(plugin, id) {},\n            closeApplicationBoardDialog() {\n                ApplicationBoardModal.close()\n            },\n        },\n        process.env.NODE_ENV === 'development',\n        signal,\n    )\n    host.__builtInPluginInfraBridgeCallback__ = __builtInPluginInfraBridgeCallback__\n    host.onPluginListUpdate()\n}\nfunction __builtInPluginInfraBridgeCallback__(this: SiteAdaptorPluginHost, id: string) {\n    let instance: SiteAdaptorInstance | undefined\n\n    const base: Plugin.Shared.Definition = {\n        enableRequirement: {\n            supports: { type: 'opt-out', sites: {} },\n            target: 'beta',\n        },\n        ID: id as PluginID,\n        // TODO: read i18n files\n        // TODO: read the name from the manifest\n        name: { fallback: '__generated__bridge__plugin__' + id },\n        experimentalMark: true,\n    }\n    const def: Plugin.DeferredDefinition = {\n        ...base,\n        SiteAdaptor: {\n            hotModuleReload: (reload) => hot?.set(id, reload),\n            async load() {\n                return { default: site }\n            },\n        },\n    }\n\n    const site: Plugin.SiteAdaptor.Definition = {\n        ...base,\n        init: async (signal, context) => {\n            try {\n                const [i] = await this.startPlugin_bridged(id, signal)\n                instance = i\n            } catch (error) {\n                console.error(`[Sandboxed-plugin] Plugin ${id} stopped due to an error when starting.`, error)\n            }\n        },\n        get CompositionDialogEntry() {\n            if (!instance?.CompositionEntry) return undefined\n            return {\n                label: Children.only(instance.CompositionEntry.label),\n                dialog({ onClose, open }: Plugin.SiteAdaptor.CompositionDialogEntry_DialogProps) {\n                    if (open) return createElement(instance!.CompositionEntry!.dialog as any, { onClose, open })\n                    return null\n                },\n            }\n        },\n        CompositionDialogMetadataBadgeRender(key, meta) {\n            if (!key.startsWith(id + ':')) return null\n            const k = key.slice(id.length + 1)\n            return instance!.CompositionDialogMetadataBadgeRender(k, meta)\n        },\n    }\n    if (hot?.has(id)) hot.get(id)!(def.SiteAdaptor!.load())\n    else registerPlugin(def)\n}\n","import * as React from 'react';\nimport PropTypes from 'prop-types';\nimport { CacheProvider } from '@emotion/react';\nimport createCache from '@emotion/cache'; // prepend: true moves MUI styles to the top of the <head> so they're loaded first.\n// It allows developers to easily override MUI styles with other styling solutions, like CSS modules.\n\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nconst cache = createCache({\n  key: 'css',\n  prepend: true\n});\nexport default function StyledEngineProvider(props) {\n  const {\n    injectFirst,\n    children\n  } = props;\n  return injectFirst ? /*#__PURE__*/_jsx(CacheProvider, {\n    value: cache,\n    children: children\n  }) : children;\n}\nprocess.env.NODE_ENV !== \"production\" ? StyledEngineProvider.propTypes = {\n  /**\n   * Your component tree.\n   */\n  children: PropTypes.node,\n\n  /**\n   * By default, the styles are injected last in the <head> element of the page.\n   * As a result, they gain more specificity than any other style sheet.\n   * If you want to override MUI's styles, set this prop.\n   */\n  injectFirst: PropTypes.bool\n} : void 0;"],"names":["DialogTitle","IconButton","Typography","Box","styled","Close","ArrowBack","memo","Title","theme","display","alignItems","padding","spacing","MaskDialogTitle","props","children","onBack","onClose","backButton","size","onClick","edge","color","sx","marginRight","closeButton","component","variant","flex","Dialog","DialogActions","DialogContent","useCallback","useState","usePortalShadowRoot","CrossIsolationMessages","useDialogStackActor","MaskDialog","title","open","DialogProps","isOpenFromApplicationBoard","inferredDialogProps","dialogProps","onBackdropClick","extraProps","shouldReplaceExitWithBack","TrackDialogHierarchy","closeBothCompositionDialog","events","compositionDialogEvent","sendToLocal","reason","options","container","undefined","useMaskDialog","content","actions","isOpen","setOpen","react","react_jsx_runtime","react_dom","Trans","useTranslation","mui_material","makeStyles","masknet_icons","addPeerDependenciesDOM","runtime","addNamespaceModule","esModuleInterop","Icons","object","default","createProxy","initValue","set","key","value","Object","defineProperty","configurable","__proto__","Proxy","get","_","getPrototypeOf","setPrototypeOf","v","getOwnPropertyDescriptor","createI18nHooksAndTranslate","id","useI18N","t","useMemo","bind","Translate","createElement","i18nKey","ns","PluginRuntime","PluginRunner","getURL","addPeerDependencies","AsyncCall","AsyncGeneratorCall","serializer","isManifest","Children","SiteAdaptorPluginHost","constructor","hooks","allowLocalOverrides","signal","AbortController","HostStartPlugin","isLocal","manifest","fetchManifest","TypeError","content_script","rpc","rpcGenerator","entries","MetadataBadgeRender","Map","instance","MetadataRender","CompositionEntry","CompositionDialogMetadataBadgeRender","meta","has","data","text","tooltip","only","bridgeRPC","attachMetadata","metaID","arguments","length","attachCompositionMetadata","dropMetadata","dropCompositionMetadata","closeApplicationBoardDialog","registerMetadataRender","render","registerMetadataBadgeRender","registerCompositionEntry","label","dialog","usePluginWrapper","showSnackbar","console","log","openWindow","imports","hasRPC","hasRPCGenerator","namespace","worker","channel","createRpcChannel","thenable","workerGenerator","createRpcGeneratorChannel","Flags","registerPlugin","ApplicationBoardModal","hmr","createHostAPIs","webpackHot","accept","hot","process","env","NODE_ENV","sym","Symbol","for","globalThis","sandboxedPluginRuntime","host","plugin","close","__builtInPluginInfraBridgeCallback__","onPluginListUpdate","base","enableRequirement","supports","type","sites","target","ID","name","fallback","experimentalMark","def","SiteAdaptor","hotModuleReload","reload","load","site","init","context","i","startPlugin_bridged","error","CompositionDialogEntry","startsWith","k","slice"],"sourceRoot":"","x_google_ignoreList":[0,6]}